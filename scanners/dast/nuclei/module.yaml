api_version: 1.0

id: dev/nuclei
name: nuclei
namespace: dev/nuclei

config:
  support_diff_scan: false


steps:
  - scan:
      command:
        docker:
          image: projectdiscovery/nuclei:latest
          command: -c "$ENTRYPOINT"
          entrypoint: sh
          workdir: /src
          environment:
            TARGET_URL: ${TARGET_URL:-}
            ENTRYPOINT: >-
              nuclei -u "$TARGET_URL" -nm -id "http-missing-security-headers -se /tmp/nuclei.sarif &>/dev/null
              && cat /tmp/nuclei.sarif
      format: sarif
